<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Overview • raem</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overview">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">raem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vign-01-overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/vign-02-export-spatial.html">Exporting spatial data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cneyens/raem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cneyens/raem/blob/main/vignettes/vign-01-overview.Rmd" class="external-link"><code>vignettes/vign-01-overview.Rmd</code></a></small>
      <div class="d-none name"><code>vign-01-overview.Rmd</code></div>
    </div>

    
    
<p>The <code>raem</code> package provides a set of R functions to create
an analytic element model of steady-state, single-layer groundwater flow
under the Dupuit-Forchheimer assumption. This vignette gives a short
overview of the theory and basics behind analytic element modeling and
how the <code>raem</code> package implements this in R.</p>
<div class="section level2">
<h2 id="introduction-to-analytic-element-modeling">Introduction to analytic element modeling<a class="anchor" aria-label="anchor" href="#introduction-to-analytic-element-modeling"></a>
</h2>
<p>First developed by Otto Strack and Henk Haitjema in the late 1970’s,
the analytic element modeling (AEM) approach solves a groundwater flow
problem by superposition of analytical solutions for features such as
wells, streams and recharge. Each feature is called <em>an element</em>.
By superimposing the individual solutions, the combined effect of all
elements can be calculated at any point in space. An arbitrary number of
elements can be placed at any location in the flow field. As such, the
AEM method is more flexible than single analytical solutions and can be
used to solve more complex cases. Compared to numerical solutions of the
groundwater flow problem, the AEM method is relatively fast and easy to
use and does not suffer from numerical instability or mass balance
errors. Furthermore, it does not require a spatial grid, making it
relatively scale-insensitive as results can be obtained at any scale or
zoom-level and feature geometries do not depend on an a priori chosen
model resolution. The AEM method is therefore often used for screening
studies, regional groundwater flow modeling (often as a first step), as
a “computational laboratory” for checking hypotheses, and as an
educational tool.</p>
<p>Flow is governed by the Dupuit-Forchheimer approximation which states
that the hydraulic head
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is hydrostatic at each point in the horizontal plane. In other words,
there is no variation in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
along the vertical axis and horizontal flow is evenly distributed along
the vertical axis. This reduces the dimensions of the problem, as the
solution now only depends on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
coordinates. Although there are no vertical gradients, vertical flow can
still be computed from mass balance considerations, i.e. areal recharge
at the aquifer top or leakage through the aquifer bottom. Additionally
for phreatic aquifers, the curvature of the water-table induces vertical
flow components. Besides the Dupuit-Forchheimer assumption, the aquifer
is assumed to be of infinite lateral extent, have a horizontal top and
base and is homogeneous at the scale of interest. In practice, these
assumptions appear to be (approximately) valid for cases when the
groundwater system under consideration is much wider than it is thick,
which is true for most regional aquifer systems. Groundwater flow in
those systems is predominantly horizontal.</p>
<p>In areas where there is considerable vertical flow, such as near
groundwater divides or near partially penetrating wells or streams, or
when the flow system has a similar thickness and width
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo>&lt;</mo><mspace width="0.222em"></mspace><mo>≈</mo><mn>3</mn><mo>*</mo><mi>t</mi><mi>h</mi><mi>i</mi><mi>c</mi><mi>k</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(width\lt~\approx 3*thickness)</annotation></semantics></math>,
the Dupuit-Forchheimer approximation is not valid and a different method
should be used, e.g. a numerical model of the 3D groundwater flow
equation.</p>
<div class="section level3">
<h3 id="solution-method">Solution method<a class="anchor" aria-label="anchor" href="#solution-method"></a>
</h3>
<p>For steady-state, single-layer Dupuit-Forchheimer flow in the
horizontal plane, the governing equation is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>h</mi></mrow><mrow><mi>∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mi>T</mi><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>h</mi></mrow><mrow><mi>∂</mi><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mi>N</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
T\frac{\partial^2{h}}{\partial x^2} + T\frac{\partial^2{h}}{\partial y^2} + N = 0
</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
the aquifer transmissivity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>2</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L^2/T]</annotation></semantics></math>,
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">kH</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
the horizontal hydraulic conductivity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L/T]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
the saturated thickness
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L]</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
the hydraulic head
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
a sink/source term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L/T]</annotation></semantics></math>.</p>
<p>When the aquifer is phreatic, the saturated thickness
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is variable and depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>,
which renders the flow equation non-linear when solving for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>.
Therefore, the discharge potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>3</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi~[L^3/T]</annotation></semantics></math>
is introduced so that the governing flow equation becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>Φ</mi></mrow><mrow><mi>∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>Φ</mi></mrow><mrow><mi>∂</mi><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mi>N</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
\frac{\partial^2{\Phi}}{\partial x^2} + \frac{\partial^2{\Phi}}{\partial y^2} + N = 0
</annotation></semantics></math></p>
<p>which is a linear equation that can be solved for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>.
The resulting hydraulic heads can then be computed from:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Φ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>k</mi><mi>H</mi><mi>h</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>k</mi><msup><mi>H</mi><mn>2</mn></msup><mo>+</mo><mi>k</mi><mi>H</mi><msub><mi>z</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mspace width="2.0em"></mspace><mi>h</mi><mo>≥</mo><msub><mi>z</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Φ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>k</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>−</mo><msub><mi>z</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="right" style="text-align: right"><mspace width="2.0em"></mspace><msub><mi>z</mi><mi>b</mi></msub><mo>&lt;</mo><mi>h</mi><mo>&lt;</mo><msub><mi>z</mi><mi>t</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\Phi &amp;= kHh - (\frac{1}{2}kH^2 + kHz_b) &amp;\qquad h \ge z_t \\
\Phi &amp;= \frac{1}{2}k(h - z_b)^2 &amp;\qquad z_b \lt h \lt z_t
\end{aligned}
</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>t</mi></msub><annotation encoding="application/x-tex">z_t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>b</mi></msub><annotation encoding="application/x-tex">z_b</annotation></semantics></math>
the aquifer top and bottom elevation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L]</annotation></semantics></math>,
respectively.</p>
<p>In addition to the discharge potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>,
there exists a stream function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ψ</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>3</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\Psi~[L^3/T]</annotation></semantics></math>
which is defined as a function that is constant along streamlines and
whose difference between two points is equal to the amount of water
flowing between those two points. By convention, the stream function
increases to the right when looking in the direction of flow. It can be
used to visualize the amount of flow in a groundwater system, e.g. when
constructing flow nets.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
is only defined for the Laplace equation, i.e. when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is zero. In modeling terms, this means that it is only specified outside
area-sinks (see paragraph <a href="#area-sink">Area-sink</a> below).</p>
<p>The discharge potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
and the stream function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
fulfill the Cauchy-Riemann conditions and can therefore be combined into
a complex potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
whose real and imaginary terms are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>,
respectively. By solving the flow problem in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
are solved simultaneously in the complex plane, which is described by
the complex coordinate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\zeta=x+iy</annotation></semantics></math>.
The solution in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
yields
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
and eventually
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>.</p>
<p>The negative derivative of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ζ</mi><annotation encoding="application/x-tex">\zeta</annotation></semantics></math>
is the complex discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>,
whose real component is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>x</mi></msub><annotation encoding="application/x-tex">Q_x</annotation></semantics></math>
and whose negative imaginary component is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>y</mi></msub><annotation encoding="application/x-tex">Q_y</annotation></semantics></math>,
i.e. the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
components of the discharge vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>2</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">Q~[L^2/T]</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
represents the amount of flow in the aquifer integrated along the
vertical (or, alternatively, the first derivative of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
directions). The vertical component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>z</mi></msub><annotation encoding="application/x-tex">Q_z</annotation></semantics></math>
is determined from mass balance considerations as discussed above. The
Darcy flux
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">q~[L/T]</annotation></semantics></math>
(also called <em>specific discharge</em> or <em>Darcy velocity</em>) is
computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>/</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">Q/H</annotation></semantics></math>.
The average linear flow velocity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">v~[L/T]</annotation></semantics></math>
is computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mi>/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">q/n</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
the aquifer porosity, which should represent the effective porosity.</p>
<p>Each element gives a solution for the governing flow equation in
terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>,
as well as for the complex discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>.
An element has one or more free parameters, e.g. the discharge for a
well element. These parameters may be user-specified or are a priori
unknown, in which case they need to be computed from other conditions,
e.g. a specified head. The parameters are specified at so called
<em>collocation points</em> or <em>control points</em>. Since the
solution for a given unknown element parameter depends on the results of
all other elements, the complete system of equations needs to be solved
simultaneously for all unknowns. This is done by setting up the flow
equations at the collocation points in a matrix form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math>,
which is then solved for the unknown parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.
Once the element parameters are known, the contributions of each element
to the complex potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
and the complex discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
at any point can be calculated and superimposed to form the resulting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
values, which then yield the variables of interest such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>.</p>
<p>For a more complete overview of analytic element modeling, the reader
is referred to <a href="https://www.haitjema.com/ModelingofGroundwaterFlow6312.pdf" class="external-link">Haitjema
(1995)</a>, <a href="https://books.google.be/books/about/Groundwater_Mechanics.html?id=kfFOAQAAIAAJ&amp;redir_esc=y" class="external-link">Strack
(1989)</a>, <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2002RG000111" class="external-link">Strack
(2003)</a> and <a href="https://www.researchgate.net/profile/Randall-Hunt/publication/7367473_Ground_Water_Modeling_Applications_Using_the_Analytic_Element_Method/links/5a2eae43a6fdcc17f91fa2e8/Ground-Water-Modeling-Applications-Using-the-Analytic-Element-Method.pdf" class="external-link">Hunt
(2006)</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="elements">Elements<a class="anchor" aria-label="anchor" href="#elements"></a>
</h2>
<p>An overview of the elements available in <code>raem</code> is
provided. You can specify as many elements as you like, but keep in mind
that the solution matrix increases in size for every unknown element
parameter. Currently, every head-specified element in <code>raem</code>
supplies one unknown parameter to the solution matrix. Other elements
only have user-specified (i.e. known) parameters.</p>
<p>To create an AEM model with <code>raem</code>, first we need load
<code>raem</code> and specify the aquifer parameters. The porosity value
is only required by <code><a href="../reference/flow.html">velocity()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cneyens/raem" class="external-link">raem</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">=</span> <span class="fl">10</span>     <span class="co"># hydraulic conductivity, m/d</span></span>
<span><span class="va">top</span> <span class="op">=</span> <span class="fl">10</span>   <span class="co"># aquifer top elevation, m</span></span>
<span><span class="va">base</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span> <span class="co"># aquifer bottom elevation, m</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">0.2</span>    <span class="co"># aquifer effective porosity, -</span></span></code></pre></div>
<div class="section level3">
<h3 id="well">Well<a class="anchor" aria-label="anchor" href="#well"></a>
</h3>
<p>The simplest element is a well with a specified discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>,
which can be created with the <code><a href="../reference/well.html">well()</a></code> function. It requires
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
coordinate of the well and the pumping rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
(positive for withdrawal). The well radius
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>w</mi></msub><annotation encoding="application/x-tex">r_w</annotation></semantics></math>
can also be specified (default is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.3</mn><annotation encoding="application/x-tex">0.3</annotation></semantics></math>
length units). Inside the well annulus as defined by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>w</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">r_w,</annotation></semantics></math>
the solution is undefined. When an output variable is requested inside
this circle, its location is projected onto the nearest point on the
outer annulus. It is assumed that the well is screened across the full
(saturated) aquifer.</p>
<p>As an example, we specify two extraction wells. We then create the
model with a call to <code><a href="../reference/aem.html">aem()</a></code>. This function needs the aquifer
parameters and the elements. You can supply the elements individually or
put them into a single <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>. The <code><a href="../reference/aem.html">aem()</a></code>
function automatically solves the system of equations by calling
<code><a href="../reference/aem.html">solve.aem()</a></code>. By default, the model has a variable saturated
thickness which depends on the calculated head. You can change this by
setting <code>type = 'confined'</code> to force the model to use a
constant saturated thickness, set equal to the aquifer thickness. This
may be useful when you want to force the system of equations to remain
linear when elements with a hydraulic resistance are supplied (see
below).</p>
<p>Finally, we create the contouring grid and plot the head contours in
blue and the streamlines in orange using <code><a href="../reference/contours.html">contours()</a></code>. Note
the ugly <em>branch cuts</em> (in AEM jargon) of the streamlines
extending from the well centers towards the negative x-axis, which is an
artifact of contouring the stream function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create well elements</span></span>
<span><span class="va">w1</span> <span class="op">=</span> <span class="fu"><a href="../reference/well.html">well</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">200</span>, y <span class="op">=</span> <span class="fl">0</span>, Q <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>   </span>
<span><span class="va">w2</span> <span class="op">=</span> <span class="fu"><a href="../reference/well.html">well</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">200</span>, y <span class="op">=</span> <span class="fl">0</span>, Q <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the model. This automatically solves the system of equations.</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, top <span class="op">=</span> <span class="va">top</span>, base <span class="op">=</span> <span class="va">base</span>, n <span class="op">=</span> <span class="va">n</span>, <span class="va">w1</span>, <span class="va">w2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set up the contouring grid </span></span>
<span><span class="va">xg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">600</span>, <span class="fl">600</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">yg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span>, <span class="fl">300</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot head contours and streamlines</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, variable <span class="op">=</span> <span class="st">'streamfunction'</span>, col <span class="op">=</span> <span class="st">'orange'</span>,</span>
<span>         nlevels <span class="op">=</span> <span class="fl">20</span>, drawlabels <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/well-1.png" width="672"></p>
<div class="section level4">
<h4 id="head-specified-well">Head-specified well<a class="anchor" aria-label="anchor" href="#head-specified-well"></a>
</h4>
<p>The effect of a head-specified well can be simulated where instead of
a supplied discharge rate, the hydraulic head remains fixed at the well
location. By doing so, the element parameter of the well, which is its
discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>,
needs to be calculated by the solution procedure. Such an element can be
created by <code><a href="../reference/headwell.html">headwell()</a></code>. In addition to the well coordinates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>w</mi></msub><annotation encoding="application/x-tex">x_w</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>w</mi></msub><annotation encoding="application/x-tex">y_w</annotation></semantics></math>,
a specified head
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>c</mi></msub><annotation encoding="application/x-tex">h_c</annotation></semantics></math>
at the control point needs to be supplied. By default, this control
point coincides with the well’s location. Alternatively, you could
specify this location to be somewhere else by setting the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>c</mi></msub><annotation encoding="application/x-tex">x_c</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>c</mi></msub><annotation encoding="application/x-tex">y_c</annotation></semantics></math>
coordinates. This creates a well at location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>w</mi></msub><mo>−</mo><msub><mi>y</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">x_w-y_w</annotation></semantics></math>
with a calculated discharge so that the head at location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>c</mi></msub><mo>−</mo><msub><mi>y</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">x_c-y_c</annotation></semantics></math>
equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>c</mi></msub><annotation encoding="application/x-tex">h_c</annotation></semantics></math>.
As was the case with the well element above, a well radius can be
specified for both the well and the control point. Lastly, a hydraulic
resistance at the control point location can also be supplied through
the <code>resistance</code> argument (see also the <a href="#head-specified-line-sink">Head-specified line-sink</a> section
below).</p>
<p>When solving for unknown element parameters, a <em>reference
point</em> needs to be added to the model as created by the
<code><a href="../reference/constant.html">constant()</a></code> function. This is explained in more detail below
(<a href="#reference-point">Reference point</a>).</p>
<p>In the example, two head-specified wells are created. The second well
has its control point at a different location than the well location. We
can get the computed discharge of the elements by accessing the
<code>parameter</code> value of the element in the list of elements
inside the model object. An alternative (and easier) method is to use
<code><a href="../reference/element_discharge.html">element_discharge()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create head-specified wells</span></span>
<span><span class="va">hw1</span> <span class="op">=</span> <span class="fu"><a href="../reference/headwell.html">headwell</a></span><span class="op">(</span>xw <span class="op">=</span> <span class="fl">300</span>, yw <span class="op">=</span> <span class="fl">100</span>, hc <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">hw2</span> <span class="op">=</span> <span class="fu"><a href="../reference/headwell.html">headwell</a></span><span class="op">(</span>xw <span class="op">=</span> <span class="op">-</span><span class="fl">200</span>, yw <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, xc <span class="op">=</span> <span class="fl">0</span>, yc <span class="op">=</span> <span class="fl">0</span>, hc <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create reference point element</span></span>
<span><span class="va">rf</span> <span class="op">=</span> <span class="fu"><a href="../reference/constant.html">constant</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, y <span class="op">=</span> <span class="fl">0</span>, h <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create and solve model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">hw1</span>, <span class="va">hw2</span>, <span class="va">rf</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># plot head contours</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/headwell-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># computed discharge of hw1</span></span>
<span><span class="va">m</span><span class="op">$</span><span class="va">elements</span><span class="op">$</span><span class="va">hw1</span><span class="op">$</span><span class="va">parameter</span></span>
<span><span class="co">#&gt; [1] 292.5061</span></span>
<span></span>
<span><span class="co"># computed discharge of hw2</span></span>
<span><span class="fu"><a href="../reference/element_discharge.html">element_discharge</a></span><span class="op">(</span><span class="va">m</span>, name <span class="op">=</span> <span class="st">'hw2'</span><span class="op">)</span></span>
<span><span class="co">#&gt;      hw2 </span></span>
<span><span class="co">#&gt; 779.7601</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="reference-point">Reference point<a class="anchor" aria-label="anchor" href="#reference-point"></a>
</h3>
<p>When solving for unknown element parameters, a so-called
<em>reference point</em> (or <em>reference head</em>) needs to be added
to the model in order to have enough equations in the matrix formulation
to solve for all unknowns. This is a constant value which is added to
all hydraulic head values. It can be created by the
<code><a href="../reference/constant.html">constant()</a></code> function which needs an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
coordinate and the reference head
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>c</mi></msub><annotation encoding="application/x-tex">h_c</annotation></semantics></math>.
It is important to understand that this reference point is not an actual
aquifer feature, but a mathematical necessity. Therefore, its value and
location should be chosen is such a way that it does not influence the
results too much. In general, the reference point should be never be
placed inside the zone of interest (called the <em>“near-field”</em> in
AEM lingo). It should be placed in the far-field and given a “neutral”
head value as to not induce unrealistic gradients towards the
near-field.</p>
</div>
<div class="section level3">
<h3 id="line-sink">Line-sink<a class="anchor" aria-label="anchor" href="#line-sink"></a>
</h3>
<p>Line-sinks are elements with a line geometry which can be used to
simulate groundwater flow to and from surface water features such as
streams or canals. The parameter of a line-sink is its <em>strength</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>,
which is defined as the total flow to/from the line-sink per unit length
of the line
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>2</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L^2/T]</annotation></semantics></math>
(positive going into the line-sink). The parameter is defined at a
collocation point at the center of the line-sink.</p>
<p>Here, a single line-sink is created using <code><a href="../reference/linesink.html">linesink()</a></code>. In
addition to the start- and endpoints of the line-sink
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0-y_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1-y_1</annotation></semantics></math>,
the strength parameter needs to be specified. Optionally, a width can
also be given, which for a strength-specified line-sink is only used in
particle tracking to determine when the particles have reached the
line.</p>
<p>Note that the locations of all elements in an <code>aem</code> object
with line and point geometries (except the reference point) can be
plotted using the <code><a href="../reference/aem.html">plot.aem()</a></code> method. Individual element
locations can always be plotted by calling <code><a href="../reference/aem.html">plot.element()</a></code>
on the respective element object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create line-sink</span></span>
<span><span class="va">ls</span> <span class="op">=</span> <span class="fu"><a href="../reference/linesink.html">linesink</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="op">-</span><span class="fl">200</span>, y0 <span class="op">=</span> <span class="fl">200</span>, x1 <span class="op">=</span> <span class="fl">200</span>, y1 <span class="op">=</span> <span class="op">-</span><span class="fl">200</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create and solve the model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">ls</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot head contours and line-sink geometry</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/line-sink-1.png" width="672"></p>
<div class="section level4">
<h4 id="head-specified-line-sink">Head-specified line-sink<a class="anchor" aria-label="anchor" href="#head-specified-line-sink"></a>
</h4>
<p>Although useful, strength-specified line-sinks are not often used in
modeling applications since the discharge into/from streams is often
unknown. Head-specified line-sinks on the other hand are widely used in
AEM studies, where they represent streams and other surface water
features with known water levels. The absence of a numerical grid makes
it straightforward to implement complex stream geometries.</p>
<p>A head-specified line-sink can be created with
<code><a href="../reference/headlinesink.html">headlinesink()</a></code>. In addition to the start- and endpoints of
the line, the hydraulic head at the collocation point needs to be given,
which is located at the center of the line-sink. The line-sink strength
is unknown and is calculated by solving the system of equations. When
the aquifer head is above the head of the line-sink, the line-sink is
draining the aquifer (positive line-sink strength
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>).
If the aquifer head is below the line-sink head, the line-sink is
discharging into the aquifer. In <code>raem</code>, zeroth order
line-sinks are used, which result in a constant strength along the line,
and thus a varying head. As such, a single stream with a constant head
should be approximated with many short line-sinks. Other AEM codes may
use higher order line elements where the strength can vary along the
line.</p>
<p>By default, the line-sink is assumed to be in full hydraulic contact
with the aquifer and fully penetrates the entire saturated depth.
Alternatively, a hydraulic resistance may be specified between the
aquifer and the line-sink representing the effect of a low-permeability
connection due to e.g. fine-grained streambed sediments. Additionally,
the <code>width</code> parameter is used in conjunction with the
<code>resistance</code> parameter to calculate the hydraulic
conductance. When the model has a variably-saturated thickness
(<code>type = 'variable'</code> in <code><a href="../reference/aem.html">aem()</a></code>; default), this
renders the system of equations non-linear. As such, an outer iteration
loop is entered, with a default of 10 iterations (see also
<code><a href="../reference/aem.html">aem()</a></code> and <code><a href="../reference/aem.html">solve.aem()</a></code>). As discussed above,
setting <code>type = 'confined'</code> keeps the system linear and in
which case no outer iteration is needed.</p>
<p>As a general rule of thumb, line-sinks in the far-field should not
have resistance or width values specified, so that they act as
constant-head boundaries which fix the head in the far-field. Line-sinks
in the near-field on the other hand should have resistances and widths
specified to give a more realistic representation of the surface water
features in that area.</p>
<p>As an example, a single stream is modeled with several head-specified
line-sinks. They are bundled in a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> element and
supplied to the model. A reference point also needs to be added.
Information on the iteration loop is printed by setting
<code>verbose = TRUE</code> in the <code><a href="../reference/aem.html">aem()</a></code> call.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">el</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rf <span class="op">=</span> <span class="va">rf</span><span class="op">)</span> <span class="co"># list of elements</span></span>
<span><span class="va">nls</span> <span class="op">=</span> <span class="fl">10</span>           <span class="co"># number of line-sinks</span></span>
<span><span class="va">xls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">700</span>, <span class="fl">700</span>, length <span class="op">=</span> <span class="va">nls</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># x-coordinates of line-sinks</span></span>
<span><span class="va">yls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>, <span class="va">nls</span><span class="op">)</span>, <span class="op">-</span><span class="fl">25</span><span class="op">)</span>     <span class="co"># y-coordinates of line-sinks</span></span>
<span><span class="va">hc</span> <span class="op">=</span> <span class="fl">7</span>             <span class="co"># stream level, m</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fl">2</span>            <span class="co"># hydraulic resistance of streambed, days</span></span>
<span><span class="va">width</span> <span class="op">=</span> <span class="fl">3</span>          <span class="co"># stream width, m</span></span>
<span></span>
<span><span class="co"># create head-specified line-sinks</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nls</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">hl</span> <span class="op">=</span> <span class="fu"><a href="../reference/headlinesink.html">headlinesink</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">xls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                    x1 <span class="op">=</span> <span class="va">xls</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>, </span>
<span>                    y0 <span class="op">=</span> <span class="va">yls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                    y1 <span class="op">=</span> <span class="va">yls</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>,</span>
<span>                    hc <span class="op">=</span> <span class="va">hc</span>,</span>
<span>                    resistance <span class="op">=</span> <span class="va">res</span>,</span>
<span>                    width <span class="op">=</span> <span class="va">width</span><span class="op">)</span></span>
<span>  <span class="va">el</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'hls_'</span>, <span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">hl</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># create and solve model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">el</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Solving analytic element model ... </span></span>
<span><span class="co">#&gt;  Non-linear model with 11 elements and 11 unknowns </span></span>
<span><span class="co">#&gt;  Entering outer iteration loop ... </span></span>
<span><span class="co">#&gt;   Iteration 1 </span></span>
<span><span class="co">#&gt;   Iteration 2 </span></span>
<span><span class="co">#&gt;   Iteration 3 </span></span>
<span><span class="co">#&gt;   Iteration 4 </span></span>
<span><span class="co">#&gt;   Iteration 5 </span></span>
<span><span class="co">#&gt;   Iteration 6 </span></span>
<span><span class="co">#&gt;   Iteration 7 </span></span>
<span><span class="co">#&gt;   Iteration 8 </span></span>
<span><span class="co">#&gt;   Iteration 9 </span></span>
<span><span class="co">#&gt;   Iteration 10 </span></span>
<span><span class="co">#&gt; Model solved</span></span>
<span></span>
<span><span class="co"># plot head contours</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/headlinesink-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="area-sink">Area-sink<a class="anchor" aria-label="anchor" href="#area-sink"></a>
</h3>
<p>Area-sinks are circular elements that can be added at the top or
bottom of the model. They provide a constant flux and can be used to
simulate areal recharge or leakage through the aquifer base. The
circular geometry is sufficient as long as the disc covers the entire
area of interest and the heads inside are fixed by head-specified
elements. The parameter is the specified flux value <code>N</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L/T]</annotation></semantics></math>,
defined at the center of the area-sink and applied uniformly across the
entire disc.</p>
<p>Use of an area-sink introduces vertical flow components, besides the
ones that occur due to the curvature of the water-table in a phreatic
aquifer when variably saturated thickness is used in the
<code><a href="../reference/aem.html">aem()</a></code> model. Note that the stream function does not give
reasonable results inside the area covered by an area-sink, as discussed
above.</p>
<p>The <code><a href="../reference/areasink.html">areasink()</a></code> function requires the center coordinates
of the circular area-sink, as well as the flux value <code>N</code>
(positive is into the aquifer, note that this differs from other
elements) and a radius <code>R</code>. The value of <code>R</code> is
not important as long as its large enough so that the disc covers the
modeled region. By default, the area-sink is placed at the aquifer top,
which can be overridden by setting <code>location = 'base'</code>.</p>
<p>To illustrate to effect an area-sink providing areal recharge at the
aquifer top, the example of the head-specified line-sinks above is used
and an area-sink is added. Note the increased head values compared to
the case without recharge.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add area-sink to list of elements</span></span>
<span><span class="va">el</span><span class="op">$</span><span class="va">as</span> <span class="op">=</span> <span class="fu"><a href="../reference/areasink.html">areasink</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, N <span class="op">=</span> <span class="fl">0.001</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># create and solve the model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">el</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot head contours</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/area-sink-1.png" width="672"></p>
<div class="section level4">
<h4 id="head-specified-area-sink">Head-specified area-sink<a class="anchor" aria-label="anchor" href="#head-specified-area-sink"></a>
</h4>
<p>Similar to line-sinks and head-specified line-sinks, the area-sink
can also be given a specified head. The constant flux then needs to be
calculated by solving the system of equations. Since the head is
specified at the center of the disc, the computed flux is calculated
from the head gradient at this location and applied over the entire
circular area. This is for example useful to simulate ponds or wetlands
with limited areal extent. For large lakes on the other hand, a better
representation would be to create a series of head-specified line-sinks
along the lake boundary, as that is where most of the groundwater
interaction occurs for such type of surface water features.</p>
<p>The <code><a href="../reference/headareasink.html">headareasink()</a></code> function creates a head-specified
area-sink element. Similar to <code><a href="../reference/headlinesink.html">headlinesink()</a></code>, the
<code>resistance</code> parameter determines the hydraulic resistance
between the aquifer and the area-sink. This also renders the system of
equations non-linear when the aquifer has a variable saturated thickness
(<code>type = 'variable'</code> in <code><a href="../reference/aem.html">aem()</a></code>).</p>
<p>To illustrate its use, leakage from a small, circular pond is
simulated using a head-specified area-sink applied to the model with two
extraction wells created earlier.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create head-specified area-sink</span></span>
<span><span class="va">has</span> <span class="op">=</span> <span class="fu"><a href="../reference/headareasink.html">headareasink</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                   y <span class="op">=</span> <span class="fl">200</span>, </span>
<span>                   h <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                   resistance <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                   R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create and solve model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">w1</span>, <span class="va">w2</span>, <span class="va">rf</span>, <span class="va">has</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot head contours and area-sink geometry</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">has</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">'grey50'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/headareasink-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="uniform-flow">Uniform flow<a class="anchor" aria-label="anchor" href="#uniform-flow"></a>
</h3>
<p>An element can be created which models a specified, uniform
background flow in the aquifer. In general, the regional gradient should
be modeled by including head-specified surface water elements which will
induce a background flow in the model. For certain applications however,
it may be useful to specify this uniform background flow explicitly,
e.g. when the regional system is not fully included in the model. This
can be done by using <code><a href="../reference/uniformflow.html">uniformflow()</a></code>. It requires a
transmissivity value which remains constant in the entire domain
(i.e. has a constant saturated thickness independent of the simulated
heads), a gradient which is positive in the direction of flow, and an
angle in degrees counterclockwise from the positive x-axis:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create uniform flow element</span></span>
<span><span class="va">uf</span> <span class="op">=</span> <span class="fu"><a href="../reference/uniformflow.html">uniformflow</a></span><span class="op">(</span>TR <span class="op">=</span> <span class="va">k</span> <span class="op">*</span> <span class="op">(</span><span class="va">top</span> <span class="op">-</span> <span class="va">base</span><span class="op">)</span>, gradient <span class="op">=</span> <span class="fl">0.001</span>, angle <span class="op">=</span> <span class="op">-</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create model</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span>, <span class="va">uf</span>, <span class="va">rf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot head contours</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add stream lines</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, variable <span class="op">=</span> <span class="st">'streamfunction'</span>, </span>
<span>         col <span class="op">=</span> <span class="st">'orange'</span>, nlevels <span class="op">=</span> <span class="fl">20</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/uniformflow-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-a-model">Setting up a model<a class="anchor" aria-label="anchor" href="#setting-up-a-model"></a>
</h2>
<p>As an example, an analytic element model is created for a phreatic
system with two wells near a stream which is not in full hydraulic
contact with the aquifer. The stream is approximately straight and
flowing from south to north along
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math>,
with the stream level decreasing in the direction of flow. The stream is
divided into segments which are shorter near well A. The sandy aquifer
has an approximately horizontal bottom elevation, and can be considered
homogeneous for the scale and purpose of the modeling exercise. Areal
recharge is simulated using an area-sink.</p>
<p>The <code><a href="../reference/add_element.html">add_element()</a></code> function is used to add elements to an
initially empty model. After all the elements are added, the model needs
to be solved with an explicit call to <code><a href="../reference/aem.html">solve.aem()</a></code>. This is
useful for adding elements to a model in a loop or pipeline.</p>
<p>A major benefit of the AEM approach is that no numerical grid of the
domain is needed. This allows to zoom in on an area of interest without
altering or rerunning the model, as illustrated by the plot of the inset
area around well A (green rectangular in the first plot).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aquifer parameters ----</span></span>
<span><span class="va">k</span> <span class="op">=</span> <span class="fl">15</span>          <span class="co"># hydraulic conductivity, m/d</span></span>
<span><span class="va">top</span> <span class="op">=</span> <span class="fl">20</span>        <span class="co"># aquifer top elevation, m</span></span>
<span><span class="va">base</span> <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>      <span class="co"># aquifer bottom elevation, m</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">0.2</span>         <span class="co"># aquifer effective porosity, -</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">=</span> <span class="fl">0.2</span> <span class="op">/</span> <span class="fl">365</span>   <span class="co"># areal recharge rate, m/d</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fl">2</span>         <span class="co"># streambed resistance, d</span></span>
<span><span class="va">width</span> <span class="op">=</span> <span class="fl">5</span>       <span class="co"># stream width, m</span></span>
<span><span class="va">hr</span> <span class="op">=</span> <span class="fl">17.5</span>       <span class="co"># stream level at head of stream, m</span></span>
<span><span class="va">hrg</span> <span class="op">=</span> <span class="fl">0.0005</span>    <span class="co"># gradient of stream level, -</span></span>
<span><span class="va">href</span> <span class="op">=</span> <span class="fl">18.5</span>     <span class="co"># head at reference point, m</span></span>
<span></span>
<span><span class="co"># stream coordinates and water level</span></span>
<span><span class="va">yriv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">300</span>, by <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">200</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1000</span>, by <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hriv</span> <span class="op">=</span> <span class="va">hr</span> <span class="op">-</span> <span class="op">(</span><span class="va">yriv</span> <span class="op">-</span> <span class="va">yriv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">hrg</span></span>
<span><span class="va">nls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yriv</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create elements ----</span></span>
<span><span class="va">wA</span> <span class="op">=</span> <span class="fu"><a href="../reference/well.html">well</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">300</span>, y <span class="op">=</span> <span class="fl">0</span>, Q <span class="op">=</span> <span class="fl">550</span><span class="op">)</span></span>
<span><span class="va">wB</span> <span class="op">=</span> <span class="fu"><a href="../reference/well.html">well</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">500</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">300</span>, Q <span class="op">=</span> <span class="fl">450</span><span class="op">)</span></span>
<span><span class="va">as</span> <span class="op">=</span> <span class="fu"><a href="../reference/areasink.html">areasink</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, y <span class="op">=</span> <span class="fl">0</span>, N <span class="op">=</span> <span class="va">N</span>, R <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">rf</span> <span class="op">=</span> <span class="fu"><a href="../reference/constant.html">constant</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1000</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, h <span class="op">=</span> <span class="fl">18.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create model ----</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, <span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># first, create model with no elements</span></span>
<span>  <span class="fu"><a href="../reference/add_element.html">add_element</a></span><span class="op">(</span><span class="va">wA</span><span class="op">)</span> <span class="op">|&gt;</span>        <span class="co"># add elements</span></span>
<span>  <span class="fu"><a href="../reference/add_element.html">add_element</a></span><span class="op">(</span><span class="va">wB</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_element.html">add_element</a></span><span class="op">(</span><span class="va">as</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_element.html">add_element</a></span><span class="op">(</span><span class="va">rf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add head-specified line-sinks in a loop</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nls</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">hls</span> <span class="op">=</span> <span class="fu"><a href="../reference/headlinesink.html">headlinesink</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                     x1 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                     y0 <span class="op">=</span> <span class="va">yriv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                     y1 <span class="op">=</span> <span class="va">yriv</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>,</span>
<span>                     h <span class="op">=</span> <span class="va">hriv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                     resistance <span class="op">=</span> <span class="va">res</span>,</span>
<span>                     width <span class="op">=</span> <span class="va">width</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/add_element.html">add_element</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">hls</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'stream'</span>, <span class="va">i</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># solve</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view head contours ----</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">.3</span>, <span class="fl">.3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">300</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">yg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">600</span>, <span class="fl">300</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">18.5</span>, <span class="fl">0.1</span><span class="op">)</span>, labcex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">'x (m)'</span>, ylab <span class="op">=</span> <span class="st">'y (m)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="op">-</span><span class="fl">500</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">200</span>, <span class="fl">150</span>, <span class="fl">150</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">'forestgreen'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add gridlines to plot</span></span>
<span></span>
<span><span class="co"># view inset near well A</span></span>
<span><span class="va">xg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">50</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">yg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">150</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">18</span>, <span class="fl">0.05</span><span class="op">)</span>, labcex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">'x (m)'</span>, ylab <span class="op">=</span> <span class="st">'y (m)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot control points of line-sinks</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">m</span><span class="op">$</span><span class="va">elements</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">'linesink'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">i</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, use.widths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">i</span><span class="op">$</span><span class="va">xc</span>, <span class="va">i</span><span class="op">$</span><span class="va">yc</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/example-model-1.png" width="75%"><img src="vign-01-overview_files/figure-html/example-model-2.png" width="75%"></p>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>Hydraulic heads from an <code>aem</code> object at any <code>x</code>
and <code>y</code> location can be obtained with <code><a href="../reference/state-variables.html">heads()</a></code>
(not to be confused by <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">utils::head()</a></code>). The <code>x</code>
and <code>y</code> arguments are recycled. By setting
<code>as.grid = TRUE</code>, a grid of head values is obtained by using
the <code>x</code> and <code>y</code> values as marginal grid
vectors:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/state-variables.html">heads</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">350</span>, <span class="op">-</span><span class="fl">200</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 17.46994 17.44073</span></span>
<span></span>
<span><span class="co"># as a grid</span></span>
<span><span class="fu"><a href="../reference/state-variables.html">heads</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">100</span>, length <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">100</span>, <span class="fl">60</span><span class="op">)</span>, as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]</span></span>
<span><span class="co">#&gt; [1,] 17.78207 17.68756 17.58476 17.48926 17.44123 17.44028 17.44520 17.43943</span></span>
<span><span class="co">#&gt; [2,] 17.74401 17.63636 17.50049 17.31946 17.27566 17.36877 17.41453 17.42836</span></span>
<span><span class="co">#&gt; [3,] 17.71670 17.60830 17.46713 17.23316 17.19484 17.35159 17.41181 17.43322</span></span>
<span><span class="co">#&gt; [4,] 17.69875 17.60562 17.50487 17.40761 17.37671 17.41047 17.44189 17.45568</span></span>
<span><span class="co">#&gt; [5,] 17.67895 17.60743 17.54704 17.50030 17.47868 17.48040 17.48826 17.49047</span></span>
<span><span class="co">#&gt; [6,] 17.63721 17.59317 17.57253 17.55656 17.54577 17.54085 17.53762 17.53121</span></span></code></pre></div>
<p>Similar functions exist for the discharge potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
(<code><a href="../reference/state-variables.html">potential()</a></code>), the complex potential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
(<code><a href="../reference/state-variables.html">omega()</a></code>) and the stream function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
(<code><a href="../reference/state-variables.html">streamfunction()</a></code>). The heads, potentials and stream
function can all be contoured by setting the <code>variable</code>
argument in <code><a href="../reference/contours.html">contours()</a></code> (defaults to
<code>"heads"</code>).</p>
<p>To plot a cross-section of the water-table, simply compute the head
values at the points along the profile line and plot:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xprofile</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">400</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">hprofile</span> <span class="op">=</span> <span class="fu"><a href="../reference/state-variables.html">heads</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="va">xprofile</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xprofile</span>, <span class="va">hprofile</span>, type <span class="op">=</span> <span class="st">'l'</span>, xlab <span class="op">=</span> <span class="st">'x (m)'</span>, ylab <span class="op">=</span> <span class="st">'head (m)'</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/cross-section-plot-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>The components of the discharge vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
at any <code>x</code>, <code>y</code> and <code>z</code> coordinate are
obtained from an <code>aem</code> object with the
<code><a href="../reference/flow.html">discharge()</a></code> function. Values are positive with increasing
axis value. When the specified <code>z</code> coordinate is above the
water-table or aquifer top, or below the aquifer base, <code>NA's</code>
are returned for the <code>z</code> component with a warning. Similar to
the state-variables discussed above, <code>as.grid</code> can be set to
<code>TRUE</code> to obtain an output grid for the given <code>x</code>,
<code>y</code> and <code>z</code> vectors. Furthermore, setting
<code>magnitude = TRUE</code> will return an additional column with the
vector’s magnitude, defined as the Euclidean norm of the vector
components.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flow.html">discharge</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">350</span>, <span class="op">-</span><span class="fl">200</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, z <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Qx        Qy          Qz</span></span>
<span><span class="co">#&gt; [1,]  0.5337762 0.5528572 -0.01500301</span></span>
<span><span class="co">#&gt; [2,] -0.1751007 0.4348954 -0.01418512</span></span>
<span></span>
<span><span class="co"># NA's for z-component</span></span>
<span><span class="fu"><a href="../reference/flow.html">discharge</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">350</span>, <span class="op">-</span><span class="fl">200</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, z <span class="op">=</span> <span class="va">top</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Setting Qz values to NA for z above saturated aquifer level or below</span></span>
<span><span class="co">#&gt; aquifer base</span></span>
<span><span class="co">#&gt;              Qx        Qy Qz</span></span>
<span><span class="co">#&gt; [1,]  0.5337762 0.5528572 NA</span></span>
<span><span class="co">#&gt; [2,] -0.1751007 0.4348954 NA</span></span>
<span></span>
<span><span class="co"># as.grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/flow.html">discharge</a></span><span class="op">(</span><span class="va">m</span>, </span>
<span>              x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">350</span>, <span class="op">-</span><span class="fl">200</span>, length <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">100</span>, length <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>              z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>              as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:4, 1:5, 1:3, 1:3] 0.534 0.353 0.223 0.113 0.303 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 4</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:3] "Qx" "Qy" "Qz"</span></span>
<span></span>
<span><span class="co"># magnitude</span></span>
<span><span class="fu"><a href="../reference/flow.html">discharge</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">350</span>, <span class="op">-</span><span class="fl">200</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, z <span class="op">=</span> <span class="fl">15</span>, magnitude <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Qx        Qy          Qz         Q</span></span>
<span><span class="co">#&gt; [1,]  0.5337762 0.5528572 -0.01500301 0.7686307</span></span>
<span><span class="co">#&gt; [2,] -0.1751007 0.4348954 -0.01418512 0.4690367</span></span></code></pre></div>
<p>Similar functions exist for the Darcy flux
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
(<code><a href="../reference/flow.html">darcy()</a></code>) and the average linear flow velocity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
(<code><a href="../reference/flow.html">velocity()</a></code>). The latter uses the aquifer porosity value
set in the <code>aem</code> object. Additionally, a retardation
coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
can be specified (defaults to 1, i.e. no retardation), in which case the
apparent velocity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mo>*</mo></msup><mo>=</mo><mi>v</mi><mi>/</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">v^*=v/R</annotation></semantics></math>
is used instead of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="particle-traces">Particle traces<a class="anchor" aria-label="anchor" href="#particle-traces"></a>
</h2>
<p>Tracelines of particles can be computed using
<code><a href="../reference/tracelines.html">tracelines()</a></code>. It tracks particle locations through the flow
field by numerically integrating the velocity vector calculated by
<code><a href="../reference/flow.html">velocity()</a></code>. By connecting the locations of a particle in
time, its traceline can be drawn. Besides the <code>aem</code> object,
the initial <code>x</code>, <code>y</code> and <code>z</code> locations
of each particle need to be specified. When the initial <code>z</code>
location is above the water-table or aquifer top, or below the aquifer
base, it is reset to its nearest boundary with a warning. The
<code>times</code> argument is a numeric vector with the requested
tracking times.</p>
<p>The output is a list of matrices (one for each particle) with columns
<code>time</code>, <code>x</code>, <code>y</code> and <code>z</code>,
containing the tracking time and particle location. The final row
represents the particle’s location at the final time or, when it
terminated prematurely, at the time of termination. Termination occurs
when a particle enters a well’s inner radius, crosses a draining
line-sink, or exits through leakage at the aquifer bottom or top, which
is represented by the water-table in a phreatic aquifer.</p>
<p>A single matrix of all final particle locations can be obtained from
the output of <code><a href="../reference/tracelines.html">tracelines()</a></code> by using the
<code><a href="../reference/tracelines.html">endpoints()</a></code> function. The output of
<code><a href="../reference/tracelines.html">tracelines()</a></code> can be plotted using
<code><a href="../reference/tracelines.html">plot.tracelines()</a></code>. The endpoints can simply be added by
using <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate particle traces</span></span>
<span><span class="va">paths</span> <span class="op">=</span> <span class="fu"><a href="../reference/tracelines.html">tracelines</a></span><span class="op">(</span><span class="va">m</span>, </span>
<span>                   x0 <span class="op">=</span> <span class="op">-</span><span class="fl">600</span>, </span>
<span>                   y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">200</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   z0 <span class="op">=</span> <span class="va">top</span>, </span>
<span>                   times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span> <span class="op">*</span> <span class="fl">365</span>, <span class="fl">365</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># 10 steps per year for 5 years</span></span>
<span><span class="co">#&gt; Warning: Resetting z0 values above saturated aquifer level or below aquifer</span></span>
<span><span class="co">#&gt; base</span></span>
<span></span>
<span><span class="co"># plot head contours and element geometries around well A</span></span>
<span><span class="va">xg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">600</span>, <span class="fl">100</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">yg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">200</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add tracelines to plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paths</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute and plot endpoints</span></span>
<span><span class="va">endp</span> <span class="op">=</span> <span class="fu"><a href="../reference/tracelines.html">endpoints</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">endp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/tracelines-1.png" width="672"></p>
<p>Backward particle tracking can be performed by setting
<code>forward = FALSE</code>. A retardation coefficient <code>R</code>
can be passed to <code><a href="../reference/flow.html">velocity()</a></code>. When plotting the tracelines
with <code><a href="../reference/tracelines.html">plot.tracelines()</a></code>, markers at a specified time
interval can be placed by setting <code>marker</code> to the desired
interval, e.g. every 180 days.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute backward particle tracking with retardation</span></span>
<span><span class="va">backward</span> <span class="op">=</span> <span class="fu"><a href="../reference/tracelines.html">tracelines</a></span><span class="op">(</span><span class="va">m</span>, </span>
<span>                      x0 <span class="op">=</span> <span class="op">-</span><span class="fl">250</span>, </span>
<span>                      y0 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, </span>
<span>                      z <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                      forward <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                      R <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>                      times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span> <span class="op">*</span> <span class="fl">365</span>, <span class="fl">365</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the head contours and element geometries around well A</span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot backward particle trace with a marker every 1.5 years</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">backward</span>, col <span class="op">=</span> <span class="st">'forestgreen'</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, marker <span class="op">=</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/backward-tracking-1.png" width="672"></p>
<p>Lastly, particle tracking can be computationally expensive. Since the
particles are independent of one another, the computations are <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel" class="external-link">embarrassingly
parallel</a> however. <code><a href="../reference/tracelines.html">tracelines()</a></code> allows parallel
computation of the particle traces by setting the <code>ncores</code>
argument larger than zero. This distributes the calculations among
<code>ncores</code> cores using the <code>parallel</code> package, one
of the base packages in R.</p>
<p>For more examples of particle tracking, see the
<code><a href="../reference/tracelines.html">tracelines()</a></code> documentation.</p>
<div class="section level3">
<h3 id="capture-zone">Capture zone<a class="anchor" aria-label="anchor" href="#capture-zone"></a>
</h3>
<p>A special case of particle tracking is the capture zone delineation
for a well. This can be done using <code><a href="../reference/capzone.html">capzone()</a></code>, a thin
wrapper around <code><a href="../reference/tracelines.html">tracelines()</a></code> which places <code>npar</code>
evenly distributed particles around the well’s radius and tracks them
back in time using time steps of length <code>dt</code> until the
requested capture time is reached. By plotting the tracelines, the
capture zone can be be delineated. Initial particle locations are placed
at the aquifer base (<code>zstart</code> argument). Different results
may be obtained in models with vertical flow components by placing
initial particle locations at different <code>zstart</code> values. By
increasing the amount of particles or decreasing the time step length, a
sharper delineation of the capture zone envelope may be obtained.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5-year capture zone of well A</span></span>
<span><span class="va">cpA_5</span> <span class="op">=</span> <span class="fu"><a href="../reference/capzone.html">capzone</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">wA</span>, time <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">365</span>, npar <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># plot head contours and element geometries</span></span>
<span><span class="va">xg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">300</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">yg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">600</span>, <span class="fl">300</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/contours.html">contours</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">xg</span>, <span class="va">yg</span>, col <span class="op">=</span> <span class="st">'dodgerblue'</span>, nlevels <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot capture zone output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cpA_5</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vign-01-overview_files/figure-html/capzone-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="additional-functionality">Additional functionality<a class="anchor" aria-label="anchor" href="#additional-functionality"></a>
</h2>
<p><code>raem</code> contains some additional functionality which may be
useful in some cases. These are listed below. Examples are shown in the
respective documentation pages.</p>
<ul>
<li>
<code><a href="../reference/satthick.html">satthick()</a></code> calculates the saturated thickness of the
aquifer at given <code>x</code> and <code>y</code> locations. For a
confined aquifer, the saturated thickness always equals the aquifer
thickness.</li>
<li>
<code><a href="../reference/dirflow.html">dirflow()</a></code> computes a flow variable (discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>,
Darcy flux
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
or velocity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>)
in the direction of a given angle. This may be useful to see what the
amount of flow is in a certain direction besides parallel to the
<code>x</code>, <code>y</code> and <code>z</code> axes.</li>
<li>
<code><a href="../reference/flow_through_line.html">flow_through_line()</a></code> calculates the amount of flow
passing through a straight line by numerically integrating the requested
flow variable
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>).</li>
<li>As shown above, <code><a href="../reference/element_discharge.html">element_discharge()</a></code> gets the computed
discharge
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>L</mi><mn>3</mn></msup><mi>/</mi><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[L^3/T]</annotation></semantics></math>)
for a given element or element type, positive discharge being out of the
aquifer.</li>
</ul>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>The references given at the end of <a href="#introduction-to-analytic-element-modeling">Introduction to
analytic element modeling</a> are highly recommended for anyone wanting
to learn more about analytic element modeling theory and its
applications. <a href="https://www.routledge.com/Analytical-Groundwater-Modeling-Theory-and-Applications-using-Python/Bakker-Post/p/book/9781138029392" class="external-link">Bakker
&amp; Post (2022)</a> is another book that serves as a great
introduction to analytic element modeling, and analytical groundwater
flow modeling in general. <code>raem</code> started out as an R
implementation of some of the material in that book. Readers familiar
with Bakker &amp; Post (2022), or with its author’s other work, will
therefore find some familiarity with the naming conventions and general
coding structure in <code>raem</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cas Neyens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
