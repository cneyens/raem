<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert hydraulic head to potential and vice versa — head_to_potential • raem</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert hydraulic head to potential and vice versa — head_to_potential"><meta name="description" content="head_to_potential() calculates the discharge potential from the hydraulic head.
potential_to_head() calculates the hydraulic head from the discharge potential."><meta property="og:description" content="head_to_potential() calculates the discharge potential from the hydraulic head.
potential_to_head() calculates the hydraulic head from the discharge potential."><meta property="og:image" content="https://cneyens.github.io/raem/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">raem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vign-01-overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/vign-02-export-spatial.html">Exporting spatial data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cneyens/raem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Convert hydraulic head to potential and vice versa</h1>
      <small class="dont-index">Source: <a href="https://github.com/cneyens/raem/blob/main/R/state-variables.R" class="external-link"><code>R/state-variables.R</code></a></small>
      <div class="d-none name"><code>head_to_potential.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>head_to_potential()</code> calculates the discharge potential from the hydraulic head.</p>
<p><code>potential_to_head()</code> calculates the hydraulic head from the discharge potential.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">head_to_potential</span><span class="op">(</span><span class="va">aem</span>, <span class="va">h</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">potential_to_head</span><span class="op">(</span><span class="va">aem</span>, <span class="va">phi</span>, na.below <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-aem">aem<a class="anchor" aria-label="anchor" href="#arg-aem"></a></dt>
<dd><p><code>aem</code> object.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>numeric hydraulic head values as vector or matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored</p></dd>


<dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>numeric discharge potential values as vector or matrix.</p></dd>


<dt id="arg-na-below">na.below<a class="anchor" aria-label="anchor" href="#arg-na-below"></a></dt>
<dd><p>logical indicating if calculated head values below the aquifer base should be set to <code>NA</code>. Defaults to <code>TRUE</code>. See details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>head_to_potential()</code> returns the discharge potentials calculated from <code>h</code>, in the same
structure as <code>h</code>.</p>
<p><code>potential_to_head()</code> returns the hydraulic heads calculated from <code>phi</code>, in the same
structure as <code>phi</code>.</p>
<p>The conversion of potential to head or vice versa is different for confined (constant saturated thickness)
and unconfined (variable saturated thickness) aquifers as set by the <code>type</code> argument in <code><a href="aem.html">aem()</a></code>.</p>
<p>If <code>na.below = FALSE</code>, negative potentials can be converted to hydraulic heads if flow is unconfined (<code>aem$type = 'variable'</code>).
The resulting heads are below the aquifer base. This may be useful for some use cases, e.g. in preliminary model construction
or for internal functions. In most cases however, these values should be set to <code>NA</code> (the default behavior) since other analytic
elements will continue to extract or inject water even though the saturated thickness of the aquifer is negative,
which is not realistic. In those cases, setting <code>aem$type = 'confined'</code> might prove useful. Also note that these heads below the
aquifer base will not be correctly re-converted to potentials using <code>head_to_potential()</code>. As such, caution should be taken when
setting <code>na.below = FALSE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fl">10</span>; <span class="va">base</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">uf</span> <span class="op">&lt;-</span> <span class="fu"><a href="uniformflow.html">uniformflow</a></span><span class="op">(</span>TR <span class="op">=</span> <span class="fl">100</span>, gradient <span class="op">=</span> <span class="fl">0.001</span>, angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="constant.html">constant</a></span><span class="op">(</span><span class="va">TR</span>, xc <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, yc <span class="op">=</span> <span class="fl">0</span>, hc <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="well.html">well</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">50</span>, Q <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, n <span class="op">=</span> <span class="fl">0.2</span>, <span class="va">uf</span>, <span class="va">rf</span>, <span class="va">w1</span>, type <span class="op">=</span> <span class="st">'variable'</span><span class="op">)</span> <span class="co"># variable saturated thickness</span></span></span>
<span class="r-in"><span><span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="aem.html">aem</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">top</span>, <span class="va">base</span>, n <span class="op">=</span> <span class="fl">0.2</span>, <span class="va">uf</span>, <span class="va">rf</span>, <span class="va">w1</span>, type <span class="op">=</span> <span class="st">'confined'</span><span class="op">)</span> <span class="co"># constant saturated thickness</span></span></span>
<span class="r-in"><span><span class="va">xg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">500</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">250</span>, <span class="fl">250</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="state-variables.html">heads</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="va">xg</span>, y <span class="op">=</span> <span class="va">yg</span>, as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="state-variables.html">heads</a></span><span class="op">(</span><span class="va">mc</span>, x <span class="op">=</span> <span class="va">xg</span>, y <span class="op">=</span> <span class="va">yg</span>, as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pot</span> <span class="op">&lt;-</span> <span class="fu">head_to_potential</span><span class="op">(</span><span class="va">m</span>, <span class="va">h</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">potc</span> <span class="op">&lt;-</span> <span class="fu">head_to_potential</span><span class="op">(</span><span class="va">mc</span>, <span class="va">hc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="state-variables.html">potential</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="va">xg</span>, y <span class="op">=</span> <span class="va">yg</span>, as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phic</span> <span class="op">&lt;-</span> <span class="fu"><a href="state-variables.html">potential</a></span><span class="op">(</span><span class="va">mc</span>, x <span class="op">=</span> <span class="va">xg</span>, y <span class="op">=</span> <span class="va">yg</span>, as.grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hds</span> <span class="op">&lt;-</span> <span class="fu">potential_to_head</span><span class="op">(</span><span class="va">m</span>, <span class="va">phi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hdsc</span> <span class="op">&lt;-</span> <span class="fu">potential_to_head</span><span class="op">(</span><span class="va">mc</span>, <span class="va">phic</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Converting negative potentials results in NA's with warning</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu">potential_to_head</span><span class="op">(</span><span class="va">m</span>, <span class="op">-</span><span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NaN</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># unless na.below = FALSE</span></span></span>
<span class="r-in"><span><span class="fu">potential_to_head</span><span class="op">(</span><span class="va">m</span>, <span class="op">-</span><span class="fl">300</span>, na.below <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -7.745967</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cas Neyens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

